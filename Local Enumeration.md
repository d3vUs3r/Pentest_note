# Local Enumeration
* [System enumeration](#System-enumeration)
* [User and group enumeration](#user-and-group-enumeration)
* [Network enumeration](#Network-enumeration)
* [Firewall and antivirus enumeration](#Firewall-and-antivirus-enumeration)
* [Tools](#Tools)
* [MyScript](#MyScript)

## System enumeration
```
Get-CimInstance -ClassName Win32_OperatingSystem | Select-Object -Property CSName,
Caption, Version,BuildNumber, BuildType, OSType, RegisteredUser, OSArchitecture,
ServicePackMajorVersion, ServicePackMinorVersion
Get-Service | Where-Object { $_.Status -eq "Running" }
```

### systeminfo
```
systeminfo
```
### OS version

```
meterpreter> systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
```

### Windows hotfixes or patches have been installed
This information is useful for finetuning your approach in terms of vulnerabilities in the operating system that may have already been patched.
```
CMD> wmic qfe get Caption,Description,HotFixID,InstalledOn
```
### Enumerate Hostname
The hostname is used to identify systems on a network and may shed some light on the role of the system or the person the system belongs to.
```
CMD> hostname
```
View Boot Time
```
CMD> net statistics workstation
```

### Enumerate Shares
Enumerate drives that are attached to the system.
```
CMD> wmic logicaldisk get caption
```
Enumerate Local shares:
```
CMD> wmic share get name,path
```
### Enumerate process running
Enumerate information regarding the processes that are currently running.
```
CMD> tasklist /SVC
```
View Scheduled Task Details
```
CMD> schtasks /query /fo LIST /v
```
View Installed Programs and Versions
```
CMD> wmic product get name,version
```
View Running Processes and Paths
```
CMD> wmic process get caption,executablepath,commandline
```
View Process Details
```
CMD> wmic process get caption,commandline,processid /value
```
View Services
```
CMD> wmic service list brief
```
View Startup Program Information
```
CMD> wmic startup get command,caption
```
## User and group enumeration:
Determine the current user:
```
CMD> whoami
```
View user information
```
CMD> whoami /all
```
Determine current user privileges:
```
CMD> whoami /priv
```
Determine the groups that our account is part of:
```
CMD> whoami /groups
```
Determine active user accounts:
```
CMD> net user
CMD> net user <username>
```
Identify Users logged onto the machine:
```
CMD> query user || qwinsta
```
Identify Administrators users:
```
CMD> net localgroup administrators
```
List of recently opened files and folders on the computer:
```
CMD> dir %APPDATA%\Microsoft\Windows\Recent
```
View CMD History Commands
```
CMD> doskey /history
```

## Network enumeration:
Enumerating the target network interfaces:
```
CMD> ipconfig /all
CMD> route print
```
View ARP Cache
```
CMD> arp -A
```
Enumerate services are running:
```
CMD> netstat -ano
```
Display a list of all the wireless network profiles:
```
CMD> netsh wlan show profiles
```
View Hosts File
```
CMD> type C:\\Windows\\System32\\drivers\\etc\\hosts
```
View DNS Cache
```
CMD> ipconfig /displaydns
```

## Firewall and antivirus enumeration:
Enumerate information regarding the firewall's status and configuration.
```
CMD> netsh firewall show state
```
View Firewall Configuration
```
CMD> netsh firewall show config
```

Identify the status of Windows Defender:
```
CMD> sc query windefend
```
Identify the status of Microsoft Defender for Endpoints
```
CMD> sc query Sense
PS> Get-MpPreference | Select-Object -ExpandProperty RealTimeProtectionEnabled
```
If Microsoft Defender for Endpoint is enabled on a system, the following registry key should be present:
```
HKLM\SOFTWARE\Microsoft\ Windows Advanced Threat Protection\Status
```
To Identify third-party antivirus solutions. List the services that are running on the system.
```
CMD> sc queryex type=service
```

Output all data found in the AntiVirus class within the root/SecurityCenter2 namespace.
```
PS> gcim -Namespace root/SecurityCenter2 -ClassName AntivirusProduct
```


## Tools
### Local Exploit Suggester
The Local Exploit Suggester is a post-exploitation module for Metasploit that is used to scan a target for potential exploits based on operating system information. It automates the process of enumerating the system information and provides exploit recommendations based on the operating system's version and installed patches.
```
meterpreter> use post/multi/recon/local_exploit_suggester
meterpreter> set SESSION <Session Number>
meterpreter> run
```
### Windows Privilege Escalation Awesome Script (winPEAS) 
https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS
### JAWS - Just Another Windows (Enum) Script
https://github.com/411Hall/JAWS
### HostEnum.ps1 (to test)
https://github.com/threatexpress/red-team-scripts/blob/master/HostEnum.ps1

## MyScript
### LocalEnumerationModule
The LocalEnumerationModule is a PowerShell module designed to facilitate the collection of various system and network information from a local Windows system. It provides a collection of functions that leverage common command-line utilities and Windows Management Instrumentation (WMI) queries to retrieve valuable insights about the system's configuration, users, processes, services, network, and more.

[Download LocalEnumerationModule.psm1](assets/powershell_script/LocalEnumerationModule.psm1)

Features

  - Retrieve system information, including operating system details, hardware specifications, and system uptime.
  - Obtain user and group information, identify active user accounts, and determine their privileges.
  - Gather network-related details, including network configuration, DNS cache, hosts file contents, and SMB shared paths.
  - Discover running processes, their paths, and detailed information about them.
  - View installed programs, patches (hotfixes), and startup programs.
  - Explore service information, including service display names, statuses, and start types.
  - Examine firewall configuration and details about scheduled tasks.
  - Identify online users and their session information.
  - Obtain system boot time and a list of recently used items.
  - Retrieve details about the system's startup programs.

```
PS> Import-Module -Name .\LocalEnumerationModule.psm1
```



