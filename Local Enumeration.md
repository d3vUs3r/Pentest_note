# Local Enumeration

* [System enumeration](#System-enumeration)
* [User and group enumeration](#user-and-group-enumeration)
* [Network enumeration](#Network-enumeration)
* [Firewall and antivirus enumeration](#Firewall-and-antivirus-enumeration)
* [Tools](#Tools)


## System enumeration
### OS version
```
meterpreter> systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
```
### Windows hotfixes or patches have been installed
This information is useful for finetuning your approach in terms of vulnerabilities in the operating system that may have already been patched.

```
CMD> wmic qfe
```
### Enumerate Hostname
The hostname is used to identify systems on a network and may shed some light on the role of the system or the person the system belongs to.

```
CMD> hostname
```
### Enumerate Shares
Enumerate drives that are attached to the system.

```
CMD> wmic logicaldisk get caption
or 
CMD> drives
```
Enumerate Local shares:
```
CMD> net share
```

### Enumerate process running
Enumerate information regarding the processes that are currently running.

```
CMD> tasklist /SVC
```
## User and group enumeration:
Determine the current user:

```
CMD> whoami
```
Determine current user privileges:

```
CMD> whoami /priv
```
Determine the groups that our account is part of:

```
CMD> whoami /groups
```

Determine active user accounts:

```
CMD> net user
CMD> net user <username>
```

Identify Users logged onto the machine:
```
CMD> QWINSTA
```
Identify Administrators users:

```
CMD> net localgroup administrators
```

## Network enumeration:
Enumerating the target network interfaces:

```
CMD> ipconfig /all
CMD> route print
```
Enumerate services are running:

```
CMD> netstat -ano
```
## Firewall and antivirus enumeration:

Identify the status of Windows Defender:

```
CMD> sc query windefend
```
Identify the status of Microsoft Defender for Endpoints
```
CMD> sc query Sense

PS> Get-MpPreference | Select-Object -ExpandProperty RealTimeProtectionEnabled


```
If Microsoft Defender for Endpoint is enabled on a system, the following registry key should be present:
```
HKLM\SOFTWARE\Microsoft\ Windows Advanced Threat Protection\Status
```

To Identify third-party antivirus solutions. List the services that are running on the system.

```
CMD> sc queryex type=service
```

Enumerate information regarding the firewall's status and configuration.

```
CMD> netsh firewall show state
```
## Tools

### Local Exploit Suggester
The Local Exploit Suggester is a post-exploitation module for Metasploit that is used to scan a target for potential exploits based on operating system information. It automates the process of enumerating the system information and provides exploit recommendations based on the operating system's version and installed patches.

```
meterpreter> use post/multi/recon/local_exploit_suggester
meterpreter> set SESSION <Session Number>
meterpreter> run
```
### Windows Privilege Escalation Awesome Script (winPEAS) 
https://github.com/carlospolop/PEASS-ng/tree/master/winPEAS

### JAWS - Just Another Windows (Enum) Script
https://github.com/411Hall/JAWS

### HostEnum.ps1 (to test)
https://github.com/threatexpress/red-team-scripts/blob/master/HostEnum.ps1
